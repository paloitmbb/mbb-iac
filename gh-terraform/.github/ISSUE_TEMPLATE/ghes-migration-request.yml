name: "GHES → GHEC Migration Request"
description: "Request migration of a repository from GitHub Enterprise Server (GHES) to GitHub Enterprise Cloud (GHEC) using GEI CLI"
title: "[Migration] "
labels: ["ghes-migration-request"]
body:
  - type: markdown
    attributes:
      value: |
        ## GHES → GHEC Repository Migration
        Use this form to request migration of a repository from GitHub Enterprise Server to GitHub Enterprise Cloud.

        The workflow handles initiating the migration job, validating the target configuration,
        and performing post-migration setup such as permissions and branch protection.

        > **Prerequisites:**
        > - GHES version >= 3.4.1
        > - Source repo must not be archived
        > - Target organization must exist in GHEC

  - type: markdown
    attributes:
      value: |
        ### Source (GHES)

  - type: input
    id: ghes_server_url
    attributes:
      label: "GHES Server URL"
      description: "The base URL of the GitHub Enterprise Server instance"
      placeholder: "https://ghes.company.com"
    validations:
      required: true

  - type: input
    id: source_organization
    attributes:
      label: "Source Organization"
      description: "The organization name on GHES that owns the repository"
      placeholder: "legacy-org"
    validations:
      required: true

  - type: input
    id: source_repo
    attributes:
      label: "Source Repository Name"
      description: "The exact repository name on GHES to migrate"
      placeholder: "my-legacy-app"
    validations:
      required: true

  - type: markdown
    attributes:
      value: |
        ### Target (GHEC)

  - type: input
    id: target_organization
    attributes:
      label: "Target Organization"
      description: "The GHEC organization where the repository will be migrated to"
      placeholder: "my-ghec-org"
    validations:
      required: true

  - type: input
    id: target_repo
    attributes:
      label: "Target Repository Name"
      description: "Name for the repository in GHEC (leave same as source if unchanged)"
      placeholder: "my-legacy-app"
    validations:
      required: true

  - type: dropdown
    id: target_visibility
    attributes:
      label: "Target Visibility"
      description: "Visibility of the repository in GHEC"
      options:
        - private
        - internal
        - public
      default: 0
    validations:
      required: true

  - type: markdown
    attributes:
      value: |
        ### Migration Options

  - type: checkboxes
    id: migration_options
    attributes:
      label: "Migration Options"
      description: "Select what to include in the migration"
      options:
        - label: "Preserve full commit history"
          required: false
        - label: "Migrate Pull Requests (open + closed)"
          required: false
        - label: "Migrate Issues (open + closed)"
          required: false
        - label: "Migrate Releases and tags"
          required: false
        - label: "Archive source repository after successful migration"
          required: false
        - label: "Lock source repository during migration (read-only)"
          required: false

  - type: input
    id: admins
    attributes:
      label: "Admins"
      description: "Comma-separated list of GitHub usernames who will be assigned admin access to the target repository after migration"
      placeholder: "user1, user2, user3"
    validations:
      required: true

  - type: textarea
    id: team_mappings
    attributes:
      label: "Team Access Mappings (Optional)"
      description: |
        Map GHES teams to GHEC teams for repository access. One mapping per line.
        Format: `<ghes-team-slug> → <ghec-team-slug> : <permission>`
        Permissions: pull, push, admin, maintain, triage
      placeholder: |
        dev-team → dev-team : push
        platform-team → platform-team : admin
        qa-team → qa-team : triage

  - type: textarea
    id: justification
    attributes:
      label: "Justification"
      description: "Reason for initiating this migration"
      placeholder: "e.g., Organization-wide migration from GHES to GHEC as per the enterprise migration plan"
    validations:
      required: true

  - type: checkboxes
    id: confirmation
    attributes:
      label: "Confirmation"
      description: "Please confirm the following before submitting"
      options:
        - label: "I have verified the source repository name and organization are correct"
          required: true
        - label: "I have notified the repository owners about this migration"
          required: true
        - label: "I understand there will be a brief freeze period during migration"
          required: true
